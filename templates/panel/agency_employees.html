{% extends "panel/base.html" %}
{% load panel_tags %}
{% block panel_content %}
<div class="mb-3">{% include "partials/breadcrumbs.html" %}</div>
<h2 class="h5 mb-4">کارمندان مشاوره</h2>

{% if employees %}
<div class="card shadow-sm">
  <div class="table-responsive">
    <table class="table table-hover mb-0">
      <thead class="table-light">
        <tr>
          <th>کاربر</th>
          <th>مشاوره املاک</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for e in employees %}
        <tr>
          <td>{{ e.get_full_name|default:e.username }}</td>
          <td>{{ e.agency.name }}</td>
          <td>
            {% if e.id in pending_removes %}
            <span class="badge bg-warning">درخواست حذف در انتظار تأیید</span>
            {% else %}
            <form method="post" action="{% url 'panel:agency_employees' %}" class="d-inline">
              {% csrf_token %}
              <input type="hidden" name="user_id" value="{{ e.id }}">
              <button type="submit" class="btn btn-sm btn-outline-danger">درخواست حذف کارمند</button>
            </form>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
<p class="text-muted small mt-2">درخواست حذف کارمند توسط ادمین سایت بررسی و تأیید می‌شود.</p>
{% else %}
<div class="card shadow-sm">
  <div class="card-body text-center py-5">
    <p class="text-muted mb-0">هنوز کارمندی در مشاوره‌های شما ثبت نشده است.</p>
    <p class="text-muted small mt-2">کاربران با نقش «کارمند مشاوره» پس از درخواست عضویت و تأیید ادمین به مشاوره اضافه می‌شوند.</p>
  </div>
</div>
{% endif %}
{% endblock %}
