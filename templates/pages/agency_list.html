{% extends "base/base.html" %}
{% load static %}
{% block extra_css %}
{% endblock extra_css %}
{% block extra_head_js %}
<script>
  (function () {
    window.onload = function () {
      var preloader = document.querySelector('.page-loading');
      if (preloader) {
        preloader.classList.remove('active');
        setTimeout(function () { preloader.remove(); }, 500);
      }
    };
  })();
</script>
{% endblock extra_head_js %}
{% block body %}
<main class="page-wrapper">
  {% include "partials/loading_spinner.html" %}
  {% include "partials/SignInModal.html" %}
  {% include "partials/SignUpModal.html" %}
  {% include "partials/header.html" %}

  <div class="container mt-5 pt-md-3 py-4 py-lg-5">
    {% include "partials/breadcrumbs.html" %}

    <div class="d-flex align-items-center justify-content-between mb-4">
      <h1 class="h4 mb-0 font-vazir">مشاوره‌های املاک</h1>
      <p class="text-muted fs-sm mb-0">مشاوره املاک و آژانس‌های معتبر</p>
    </div>

    {% if agencies %}
    <div class="row g-4">
      {% for agency in agencies %}
      <a class="col-sm-6 col-lg-4 col-xl-3" href="{{ agency.get_absolute_url }}">
        <div class="card shadow-sm card-hover border-0 h-100 text-decoration-none">
          <div class="card-body d-flex align-items-center gap-3">
            {% if agency.logo %}
            <img src="{{ agency.logo.url }}" alt="{{ agency.name }}" class="rounded flex-shrink-0" style="width: 64px; height: 64px; object-fit: cover;">
            {% else %}
            <div class="rounded bg-faded-primary d-flex align-items-center justify-content-center flex-shrink-0" style="width: 64px; height: 64px;">
              <i class="fi-building text-primary fs-4"></i>
            </div>
            {% endif %}
            <div class="min-w-0">
              <h3 class="h6 mb-1 text-nav">{{ agency.name }}</h3>
              {% if agency.cities.exists %}
              <p class="fs-sm text-muted mb-0">
                {% for c in agency.cities.all|slice:":2" %}{{ c.fa_name }}{% if not forloop.last %}، {% endif %}{% endfor %}
              </p>
              {% endif %}
            </div>
          </div>
        </div>
      </a>
      {% endfor %}
    </div>
    {% else %}
    <div class="alert alert-info">فعلاً مشاوره‌ای ثبت نشده است.</div>
    {% endif %}
  </div>

  {% include "partials/footer.html" %}
  {% include "partials/Backtotopbutton.html" %}
  {% include "base/scripts.html" %}
</main>
{% endblock body %}
{% block extra_js %}
{% endblock extra_js %}
